<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Cookie Test</title>
  
<!-- OneTrust Cookies Consent Notice start for captdeadbat.github.io/ot/index.html -->

<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js"  type="text/javascript" charset="UTF-8" data-domain-script="0196e85b-d97f-7bb9-ac6c-a0a9f4f36438-test" ></script>
<script type="text/javascript">
function OptanonWrapper() {
  if (typeof OneTrust !== "undefined" && typeof OneTrust.OnConsentChanged === "function") {
      OneTrust.OnConsentChanged(() => {
        console.log("Consent changed!");
        // Your logic here
        // const consentData = JSON.parse(localStorage.ONETRUST_WEB_STORE)[0].CONSENT;
        // console.log(consentData); // Shows all category consents
        
  // Store previous consent state
let previousConsent = {};

// Listen for changes
window.OneTrust.OnConsentChanged(function() {
  const changed = [];

  // Loop through known category IDs
  const categoryIds = ["C0002", "C0003", "C0004"]; // Performance, Functional, Targeting
  categoryIds.forEach(id => {
    const current = OptanonActiveGroups.includes(id); // true if consented
    if (previousConsent[id] !== undefined && previousConsent[id] !== current) {
      changed.push({ id, from: previousConsent[id], to: current });
    }
    previousConsent[id] = current;
  });

  console.log("Changed categories:", changed);
});



      });
  }
    else{
      console.log(typeof OneTrust);
      console.log(typeof OneTrust.OnConsentChanged);
    }
    
}
</script>
<!-- OneTrust Cookies Consent Notice end for captdeadbat.github.io/ot/index.html -->

<!-- Your custom consent change listener -->
<script>
  // document.addEventListener("DOMContentLoaded", function () {
  //   if (typeof OneTrust !== "undefined" && typeof OneTrust.OnConsentChanged === "function") {
  //     OneTrust.OnConsentChanged(() => {
  //       console.log("Consent changed!");
  //       // Your logic here
  //     });
  //   }
  //   else{
  //     console.log(typeof OneTrust);
  //     console.log(typeof OneTrust.OnConsentChanged);
  //   }
  // });

</script>
  
</head>
<body>
  <h1>Cookie Test on GitHub Pages</h1>
  <p id="cookie-status"></p>

  <script>
    // Function to get a cookie by name
    function getCookie(name) {
      const value = `; ${document.cookie}`;
      const parts = value.split(`; ${name}=`);
      if (parts.length === 2) return parts.pop().split(';').shift();
    }

    // Check if cookie exists
    let username = getCookie("username");

    if (!username) {
      // Set cookie if not found
      document.cookie = "username=JohnDoe; path=/; max-age=86400"; // 1 day
      document.getElementById("cookie-status").textContent = "Cookie set for the first time!";
    } else {
      document.getElementById("cookie-status").textContent = `Welcome back, ${username}!`;
    }
  </script>
  

<!-- OneTrust Cookies Settings button start -->
<button id="ot-sdk-btn" class="ot-sdk-show-settings">CookieÂ Settings</button>
<!-- OneTrust Cookies Settings button end -->
</body>
</html>
